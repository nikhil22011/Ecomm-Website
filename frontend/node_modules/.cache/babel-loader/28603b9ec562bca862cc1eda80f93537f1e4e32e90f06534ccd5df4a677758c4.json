{"ast":null,"code":"var _jsxFileName = \"/Users/demo/Downloads/ecommerce-main 2/frontend/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route } from 'react-router-dom';\nimport Navbar from './components/Navbar';\nimport Home from './pages/Home';\nimport Cart from './pages/Cart';\nimport Login from './pages/Login';\nimport Signup from './pages/Signup';\nimport Footer from './components/Footer';\nimport Products from './pages/Products';\nimport AuthGuard from './auth/AuthGuard';\nimport { jwtDecode } from 'jwt-decode';\nimport { useAuthStore } from './store/useAuthStore';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport NonAuthGuard from './auth/NonAuthGuard';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  const {\n    logout\n  } = useAuthStore();\n  const loggedInUser = localStorage.getItem('user');\n  const token = localStorage.getItem('token');\n  useEffect(() => {\n    // Check if token and user data are present in localStorage\n    if (loggedInUser && token) {\n      // Parse user and retrieve zustand setters\n      const user = JSON.parse(loggedInUser);\n      const setUser = useAuthStore.getState().setUser;\n      const setToken = useAuthStore.getState().setToken;\n\n      // Sync user and token into global store\n      setUser(user);\n      setToken(token);\n      try {\n        // Decode the token to extract expiry info\n        const decoded = jwtDecode(token);\n        const expirationTime = decoded.exp * 1000; // Convert to milliseconds\n        const currentTime = Date.now();\n\n        // Calculate remaining time until token expires\n        const remainingTime = expirationTime - currentTime;\n        if (remainingTime > 0) {\n          // Schedule automatic logout when token expires\n          const timeoutId = setTimeout(() => {\n            logout(); // Clear store + localStorage\n          }, remainingTime);\n          // Cleanup function to clear the timeout if component unmounts\n          return () => clearTimeout(timeoutId);\n        } else {\n          // Token has already expired — logout immediately\n          logout();\n        }\n      } catch (err) {\n        // Token is invalid or corrupted — logout for safety\n        console.error(\"Invalid token:\", err);\n        logout();\n      }\n    }\n  }, [loggedInUser, token]); // Dependency: runs only when user or token changes\n\n  return /*#__PURE__*/_jsxDEV(Router, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col min-h-screen\",\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"flex-grow\",\n        children: /*#__PURE__*/_jsxDEV(Routes, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/\",\n            element: /*#__PURE__*/_jsxDEV(Home, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 46\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/products\",\n            element: /*#__PURE__*/_jsxDEV(AuthGuard, {\n              children: /*#__PURE__*/_jsxDEV(Products, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 74,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/cart\",\n            element: /*#__PURE__*/_jsxDEV(AuthGuard, {\n              children: /*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 79,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/login\",\n            element: /*#__PURE__*/_jsxDEV(NonAuthGuard, {\n              children: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 84,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/signup\",\n            element: /*#__PURE__*/_jsxDEV(NonAuthGuard, {\n              children: /*#__PURE__*/_jsxDEV(Signup, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 89,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {\n        position: \"top-right\",\n        autoClose: 3000,\n        hideProgressBar: false,\n        newestOnTop: false,\n        closeOnClick: true,\n        rtl: false,\n        pauseOnFocusLoss: true,\n        theme: \"dark\",\n        draggable: true,\n        pauseOnHover: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"qHI3q76D+8ipan+Te9uvkaTRPpg=\", false, function () {\n  return [useAuthStore];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","BrowserRouter","Router","Routes","Route","Navbar","Home","Cart","Login","Signup","Footer","Products","AuthGuard","jwtDecode","useAuthStore","ToastContainer","NonAuthGuard","jsxDEV","_jsxDEV","App","_s","logout","loggedInUser","localStorage","getItem","token","user","JSON","parse","setUser","getState","setToken","decoded","expirationTime","exp","currentTime","Date","now","remainingTime","timeoutId","setTimeout","clearTimeout","err","console","error","children","className","fileName","_jsxFileName","lineNumber","columnNumber","path","element","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","theme","draggable","pauseOnHover","_c","$RefreshReg$"],"sources":["/Users/demo/Downloads/ecommerce-main 2/frontend/src/App.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { BrowserRouter as Router, Routes, Route } from 'react-router-dom';\nimport Navbar from './components/Navbar';\nimport Home from './pages/Home';\nimport Cart from './pages/Cart';\nimport Login from './pages/Login';\nimport Signup from './pages/Signup';\nimport Footer from './components/Footer';\nimport Products from './pages/Products';\nimport AuthGuard from './auth/AuthGuard';\nimport { jwtDecode } from 'jwt-decode';\nimport { useAuthStore } from './store/useAuthStore';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport NonAuthGuard from './auth/NonAuthGuard';\n\n\nconst App = () => {\n    const {logout} = useAuthStore();\n    const loggedInUser = localStorage.getItem('user');\n    const token = localStorage.getItem('token');\n\n    useEffect(() => {\n        // Check if token and user data are present in localStorage\n        if (loggedInUser && token) {\n            // Parse user and retrieve zustand setters\n            const user = JSON.parse(loggedInUser);\n            const setUser = useAuthStore.getState().setUser;\n            const setToken = useAuthStore.getState().setToken;\n    \n            // Sync user and token into global store\n            setUser(user);\n            setToken(token);\n            try {\n                // Decode the token to extract expiry info\n                const decoded = jwtDecode(token);\n                const expirationTime = decoded.exp * 1000; // Convert to milliseconds\n                const currentTime = Date.now();\n    \n                // Calculate remaining time until token expires\n                const remainingTime = expirationTime - currentTime;\n    \n                if (remainingTime > 0) {\n                    // Schedule automatic logout when token expires\n                    const timeoutId = setTimeout(() => {\n                        logout(); // Clear store + localStorage\n                    }, remainingTime);    \n                    // Cleanup function to clear the timeout if component unmounts\n                    return () => clearTimeout(timeoutId);\n                } else {\n                    // Token has already expired — logout immediately\n                    logout();\n                }\n            } catch (err) {\n                // Token is invalid or corrupted — logout for safety\n                console.error(\"Invalid token:\", err);\n                logout();\n            }\n\n            \n        }\n    }, [loggedInUser, token]); // Dependency: runs only when user or token changes\n    \n\n    return (\n    <Router>\n        <div className=\"flex flex-col min-h-screen\">\n            <Navbar />\n            <main className=\"flex-grow\">\n                <Routes>\n                    <Route path=\"/\" element={<Home />} />\n                    <Route path=\"/products\" element={\n                        <AuthGuard>\n                            <Products />\n                        </AuthGuard>\n                    } />\n                    <Route path=\"/cart\" element={\n                        <AuthGuard>\n                            <Cart />\n                        </AuthGuard>\n                    } />\n                    <Route path=\"/login\" element={\n                        <NonAuthGuard>\n                            <Login />\n                        </NonAuthGuard>\n                    } />\n                    <Route path=\"/signup\" element={\n                        <NonAuthGuard>\n                            <Signup />\n                        </NonAuthGuard>\n                    } />\n                </Routes>\n            </main>\n            <Footer />\n            <ToastContainer \n                position=\"top-right\" \n                autoClose={3000} \n                hideProgressBar={false}\n                newestOnTop={false}\n                closeOnClick\n                rtl={false}\n                pauseOnFocusLoss\n                theme=\"dark\"\n                draggable\n                pauseOnHover\n            />\n        </div>\n    </Router>\n    );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}